# 建立暫存表、核心表與維度表

1.建立StaggingSale表，規格同源頭資料：

```
CREATE TABLE Stagingsales (
    transaction_id INT PRIMARY KEY,
    transactional_date DATETIME,
    product_id VARCHAR(255),
    customer_id INT,
    payment VARCHAR(255),
    credit_card BIGINT,
    loyalty_card VARCHAR(255),
    cost DECIMAL(18,2),
    quantity INT,
    price DECIMAL(18,2)
);
```

2.建立核心層sale表、支付維度表
```
CREATE TABLE sales (
    transaction_id INT PRIMARY KEY,
    transactional_date DATETIME,
    transactional_date_fk BIGINT,
    product_id VARCHAR(255),
    product_fk INT,
    customer_id INT,
    payment_fk INT,
    credit_card BIGINT,
    cost DECIMAL(18,2),
    quantity INT,
    price DECIMAL(18,2),
    total_cost DECIMAL(18,2),
    total_price DECIMAL(18,2),
    profit DECIMAL(18,2)
);

-- 建立 Core 資料庫中的 dim_payment 維度表格
CREATE TABLE dim_payment (
    payment_pk INT IDENTITY(1,1) PRIMARY KEY,
    payment VARCHAR(255),
    loyalty_card VARCHAR(255)
);

```
