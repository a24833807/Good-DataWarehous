# 設計與建立核心層ETL(以核心層payment為例)


以Stagging的Sales事實表為例，建立核心層的payment


## 1.使用Stagging的Sales抓取payment 的資料(fullload)

```sql
SELECT   DISTINCT 
      payment=ISNULL([payment],'cash') --把null 改成cash
      ,[loyalty_card]
FROM  DW_test..Stagingsales
```


## 2. 使用kettle導入1的數據

<img width="885" height="672" alt="image" src="https://github.com/user-attachments/assets/7d51bcfd-7d3e-4ee6-a5a3-493b9f5a80a5" />


## 3. 使用2的資料到核心層payment
<img width="627" height="715" alt="image" src="https://github.com/user-attachments/assets/cd0bc475-8b9c-4e8b-ac48-2aaf000507b7" />


## 4.測試流程是否OK
<img width="1328" height="902" alt="image" src="https://github.com/user-attachments/assets/cfc5ecfb-6254-42be-a9ee-038780d5d5cf" />

